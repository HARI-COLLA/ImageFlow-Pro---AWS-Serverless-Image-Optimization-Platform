{"ast":null,"code":"import{fileToBase64}from'./utils';// Hardcoded config\nconst config={API_ENDPOINT:\"https://ke3a91dqwe.execute-api.ap-south-1.amazonaws.com/prod/optimize\",MAX_FILE_SIZE:10*1024*1024,SUPPORTED_TYPES:['image/jpeg','image/jpg','image/png','image/webp','image/gif','image/bmp']};export const optimizeImage=async(file,options)=>{try{console.log(\"üì§ Converting file to base64...\",file.name,file.size);const base64Image=await fileToBase64(file);console.log(\"‚úÖ Base64 length:\",base64Image.length);const requestBody={imageUrl:base64Image,width:parseInt(options.width)||800,format:options.format||'webp',quality:parseInt(options.quality)||85,optimizeLevel:options.optimizationLevel||'balanced'};// Add optional parameters\nif(options.sharpness)requestBody.sharpness=parseFloat(options.sharpness);if(options.contrast)requestBody.contrast=parseFloat(options.contrast);if(options.brightness)requestBody.brightness=parseFloat(options.brightness);if(options.stripMetadata!==undefined)requestBody.stripMetadata=options.stripMetadata;if(options.progressive!==undefined)requestBody.progressive=options.progressive;console.log('üöÄ Sending to API:',{endpoint:config.API_ENDPOINT,bodySize:JSON.stringify(requestBody).length,width:requestBody.width,format:requestBody.format});const response=await fetch(config.API_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(requestBody)});console.log(\"üì• API Response status:\",response.status,response.statusText);if(!response.ok){const errorText=await response.text();console.error(\"‚ùå API Error Response:\",errorText);throw new Error(\"HTTP \".concat(response.status,\": \").concat(errorText.substring(0,100)));}const data=await response.json();console.log(\"‚úÖ API Response parsed\");console.log(\"üñºÔ∏è Has optimizedImage?\",!!data.optimizedImage);console.log(\"üìä Data keys:\",Object.keys(data));if(!data.success){console.error(\"‚ùå API returned error:\",data.error);throw new Error(data.error||'Optimization failed');}// Validate response has image\nif(!data.optimizedImage){console.error(\"‚ùå No optimizedImage in response:\",data);throw new Error('Server did not return optimized image');}console.log(\"üéâ Success! Image received\");return data;}catch(error){console.error('üí• API Call failed:',error);throw new Error(\"Optimization failed: \".concat(error.message));}};export{config};","map":{"version":3,"names":["fileToBase64","config","API_ENDPOINT","MAX_FILE_SIZE","SUPPORTED_TYPES","optimizeImage","file","options","console","log","name","size","base64Image","length","requestBody","imageUrl","width","parseInt","format","quality","optimizeLevel","optimizationLevel","sharpness","parseFloat","contrast","brightness","stripMetadata","undefined","progressive","endpoint","bodySize","JSON","stringify","response","fetch","method","headers","body","status","statusText","ok","errorText","text","error","Error","concat","substring","data","json","optimizedImage","Object","keys","success","message"],"sources":["C:/Users/malla/Downloads/image-optimization-app/src/services/api.js"],"sourcesContent":["import { fileToBase64 } from './utils';\r\n\r\n// Hardcoded config\r\nconst config = {\r\n    API_ENDPOINT: \"https://ke3a91dqwe.execute-api.ap-south-1.amazonaws.com/prod/optimize\",\r\n    MAX_FILE_SIZE: 10 * 1024 * 1024,\r\n    SUPPORTED_TYPES: ['image/jpeg', 'image/jpg', 'image/png', 'image/webp', 'image/gif', 'image/bmp']\r\n};\r\n\r\nexport const optimizeImage = async (file, options) => {\r\n    try {\r\n        console.log(\"üì§ Converting file to base64...\", file.name, file.size);\r\n        const base64Image = await fileToBase64(file);\r\n        console.log(\"‚úÖ Base64 length:\", base64Image.length);\r\n        \r\n        const requestBody = {\r\n            imageUrl: base64Image,\r\n            width: parseInt(options.width) || 800,\r\n            format: options.format || 'webp',\r\n            quality: parseInt(options.quality) || 85,\r\n            optimizeLevel: options.optimizationLevel || 'balanced'\r\n        };\r\n        \r\n        // Add optional parameters\r\n        if (options.sharpness) requestBody.sharpness = parseFloat(options.sharpness);\r\n        if (options.contrast) requestBody.contrast = parseFloat(options.contrast);\r\n        if (options.brightness) requestBody.brightness = parseFloat(options.brightness);\r\n        if (options.stripMetadata !== undefined) requestBody.stripMetadata = options.stripMetadata;\r\n        if (options.progressive !== undefined) requestBody.progressive = options.progressive;\r\n        \r\n        console.log('üöÄ Sending to API:', { \r\n            endpoint: config.API_ENDPOINT,\r\n            bodySize: JSON.stringify(requestBody).length,\r\n            width: requestBody.width,\r\n            format: requestBody.format\r\n        });\r\n        \r\n        const response = await fetch(config.API_ENDPOINT, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(requestBody)\r\n        });\r\n        \r\n        console.log(\"üì• API Response status:\", response.status, response.statusText);\r\n        \r\n        if (!response.ok) {\r\n            const errorText = await response.text();\r\n            console.error(\"‚ùå API Error Response:\", errorText);\r\n            throw new Error(`HTTP ${response.status}: ${errorText.substring(0, 100)}`);\r\n        }\r\n        \r\n        const data = await response.json();\r\n        console.log(\"‚úÖ API Response parsed\");\r\n        console.log(\"üñºÔ∏è Has optimizedImage?\", !!data.optimizedImage);\r\n        console.log(\"üìä Data keys:\", Object.keys(data));\r\n        \r\n        if (!data.success) {\r\n            console.error(\"‚ùå API returned error:\", data.error);\r\n            throw new Error(data.error || 'Optimization failed');\r\n        }\r\n        \r\n        // Validate response has image\r\n        if (!data.optimizedImage) {\r\n            console.error(\"‚ùå No optimizedImage in response:\", data);\r\n            throw new Error('Server did not return optimized image');\r\n        }\r\n        \r\n        console.log(\"üéâ Success! Image received\");\r\n        return data;\r\n        \r\n    } catch (error) {\r\n        console.error('üí• API Call failed:', error);\r\n        throw new Error(`Optimization failed: ${error.message}`);\r\n    }\r\n};\r\n\r\nexport { config };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}